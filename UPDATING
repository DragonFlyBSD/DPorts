This file documents some of the problems you may encounter when upgrading
your ports.  We try our best to minimize these disruptions, but sometimes
they are unavoidable.

You should get into the habit of checking this file for changes each time
you update your ports collection, before attempting any port upgrades.


20200726:
  AFFECTS: users of net-mgmt/librenms
  AUTHOR:  dvl@FreeBSD.org

  The %%WWWDIR%%%/logs directory has been relocated to /var/log/librenms/
  via the APP_LOG directive in %%WWWDIR%%%/.env.example - this won't affect
  existing installs, but you are strongly encouraged to update your .env file
  settings and relocate your logs.

  Logs which were going to /var/log/messages and /var/log/librenms/ now only go
  to /var/log/librenms/

20200720:
  AFFECTS: users of net-mgmt/librenms
  AUTHOR:  dvl@FreeBSD.org

  As mentioned previously in 20200503 polling via cronjob has been removed as of
  release 1.63 - see
  https://community.librenms.org/t/dropping-support-for-php-7-1-and-python-2/11851

  A database upgrade is required:

     cd /usr/local/www/librenms
     sudo ./lnms migrate

  You must  migrate to the Dispatch Service:
  https://docs.librenms.org/Extensions/Dispatcher-Service/

  You may need to add LIBRENMS_USER to .env (see .env.example).

  These steps should get you running:
  * comment out the crontab entries listed above under PYPOLLER
  * populate %%WWWDIR%%/.env with:
    * APP_KEY - see farther below for how to create
    * NODE_ID - see just below for how to create
    * DB_HOST
    * DB_DATABASE
    * DB_USERNAME
    * DB_PASSWORD
  * you can create a NODE_ID with: php -r 'echo uniqid() . "\n";'
  * sysrc librenms_enable="YES"
  * service librenms start

20200719:
  AFFECTS: users of emulators/qemu
  AUTHOR: bofh@FreeBSD.org

  emulators/qemu has been updated to 4.2.1. Previous 4.1.X branch has
  been repocopied to emulators/qemu41. If someone wants to stick with 4.1.X
  branch please use one of the following command:

  # pkg install emulators/qemu41
    or
  # portmaster -o emulators/qemu41 emulators/qemu
    or
  # portupgrade -o emulators/qemu41 emulators/qemu

20200716:
  AFFECTS: users of shells/bash, shells/bash-static
  AUTHOR: ehaupt@FreeBSD.org

  In order to cleanly decouple bash from base, bash now reads `profile` from
  LOCALBASE/etc insead of from /etc. If you are using system wide bash
  configuration in /etc/profile please migrate to LOCALBASE/etc/profile

  # cp /etc/profile /usr/local/etc/profile

  or create a symlink

  # ln -s /etc/profile /usr/local/etc/

  If you encounter the following error, you may have the obsolete
  /lib/libreadline.so.8 lying around after an incomplete base update:

  ld-elf.so.1: Undefined symbol "rl_signal_event_hook" referenced from COPY relocation in /usr/local/bin/bash

  Please refer to to (23.5.6.2) in the FreeBSD Handbook on how to
  safely check for outdated files and libraries:

  https://www.freebsd.org/doc/en/books/handbook/makeworld.html

20200713:
  AFFECTS: users of mail/php7[2-4]-imap
  AUTHOR: tz@FreeBSD.org

  The imap module of PHP was compiled against cclient till now. But this lib is
  unmaintained for over 7 years. When combined with modern OpenSSL there are
  various crashes reported.

  Switching to the fork panda-cclient fixes these issues. Therefore we make the
  usage of Panda cclient the new default. If you want to use the old cclient,
  you need to enable it now!
  
20200616:
  AFFECTS: users of www/baikal
  AUTHOR: gahr@FreeBSD.org

  The www/baikal has been upated to 0.7.1. With the 0.7.0 release, our
  configuration format was updated to use YAML files. You need to go through
  the installer again but we pre-fill most values with the ones from your old
  installation. We recommend that you make a full backup of your data, as a
  safety measure. Starting with 0.7.0, Baikal stores data in both the Specific
  and the config folders. Keep this in mind when upgrading!

  Known issue:: Upgrading from versions older than 0.6.1 does not work.

20200613:
  AFFECTS: users of editors/libreoffice
  AUTHOR: fluffy@FreeBSD.org

  LibreOffice was updated to 6.4 branch with some critical changes:
  - GTK2 option is obsolete by upstream
  - GTK3 option is not more set by default because of unstable yet and have visual glitches
  - QT5 option is set by default to provide comfy visual style for every user
  - KDE option was renamed to KF5 follows upstream

  Please re-run "make config" to pick up the new defaults

20200610:
  AFFECTS: users of www/node
  AUTHOR: bhughes@FreeBSD.org

  The www/node port has been updated to Node.js v14.0.0, the latest
  upstream release. This is a major release, including many significant
  changes. Users are encouraged to read the release announcements before
  upgrading:

  https://nodejs.org/en/blog/release/v14.0.0/

20200602:
  AFFECTS: users of www/radicale
  AUTHOR: decke@FreeBSD.org

  Migration from radicale 1.x to 2.x requires that you export the storage
  with radicale 1.1.6 before updating.

  Migration instructions are available at:
  https://web.archive.org/web/20190314225402/https://radicale.org/1to2/

20200602:
  AFFECTS: users of sysutils/py-salt
  AUTHOR: krion@FreeBSD.org

  This port is moved to sysutils/py-salt-2019 and sysutils/py-salt was
  updated to version 3000.

  If you wish to use pysalt-2019 in the future, you might run the
  following command:

  # pkg set -o sysutils/py-salt:sysutils/py-salt-2019
  # pkg upgrade

20200531:
  AFFECTS: users of mail/postfix-policyd-spf-python
  AUTHOR:  yasu@utahime.org

  This port is now deprecated because upstream project is superseded by its
  successor. So uninstall this port and install mail/py-spf-engine instead.
  Keep in mind that the path of configuration file is changed from
  ${PREFIX}/etc/postfix-policyd-spf-python/policyd-spf.conf to
  ${PREFIX}/etc/python-policyd-spf/policyd-spf.conf. So you need to move
  it to new location unless you use the default one without changing.

20200526:
  AFFECTS: users of databases/mariadb104-client, databases/mariadb104-server
  AUTHOR: brnrd@FreeBSD.org

  The ports now add sample configuration files to /usr/local/etc/mysql. You
  must merge your client configation with the conf.d/client.cnf and your
  server configuration with conf.d/server.cnf.

20200518:
  AFFECTS: users of converters/libiconv
  AUTHOR: zeising@FreeBSD.org

  Support for the Japanese specific patches have been discontinued.
  These were previously added in a nondefault ports options, for people who
  needed them.
  If you still need them, it might be possible to create a port of libiconv 1.14
  which includes those patches.

20200517:
  AFFECTS: users of x11/sddm
  AUTHOR: arrowd@FreeBSD.org

  The home directory of sddm user has been moved to /var/lib/sddm. It is advised
  to run following commands as root after updating the package:

    # pw usermod -n sddm -d /var/lib/sddm
    # pwd_mkdb /etc/master.passwd
    # mv /usr/local/etc/sddm/home/state.conf /var/lib/sddm/state.conf
    # rm -rf /usr/local/etc/sddm/home

  Otherwise, SDDM will keep using /usr/local/etc/sddm/home/ as its HOME.

20200515:
  AFFECTS: users of devel/libphutil, devel/arcanist-lib, devel/phabricator
  AUTHOR: grembo@FreeBSD.org

  Upstream fully deprecated devel/libphutil and merged its functionality
  into devel/arcanist-lib and devel/phabricator. As a result, the
  devel/libphutil port will be removed from the ports tree.

  After upgrading devel/(arcanist-lib|phabricator) to version 20200514, it is
  recommended to remove the orphaned libphutil package by running:

    # pkg delete php\*-libphutil

  Alternatively, 'pkg autoremove' will also work as expected, but might
  remove orphaned packages unrelated to this update.

20200505:
  AFFECTS: users of net-im/pidgin-rocketchat
  AUTHOR: tobias.rehbein@web.de

  This port has been turned into a libpurple plugin (net-im/purple-rocketchat)
  to support other libpurple clients than pidgin.

  This also changes some dependencies and you should run the following command
  to prevent pidgin from being autoremoved.

  # mark pidgin as being not automatically installed
  pkg set -A 0 pidgin

20200504:
  AFFECTS: users of x11-wm/hs-xmonad
  AUTHOR:  arrowd@FreeBSD.org

  From now, it is recommended to use "build script" method to compile XMonad
  config. See https://github.com/xmonad/xmonad-testing/ for general info and
  port's pkg-message for concrete steps.

20200503:
  AFFECTS: users of net-mgmt/librenms
  AUTHOR:  dvl@FreeBSD.org

  Polling via cronjob is deprecated as of release 1.63
  Please see https://community.librenms.org/t/dropping-support-for-php-7-1-and-python-2/11851

  Please migrate to the Dispatch Service:
  https://docs.librenms.org/Extensions/Dispatcher-Service/

  These steps should get you running:
  * comment out the crontab entries listed above under PYPOLLER
  * populate %%WWWDIR%%/.env with:
    * APP_KEY - see farther below for how to create
    * NODE_ID - see just below for how to create
    * DB_HOST
    * DB_DATABASE
    * DB_USERNAME
    * DB_PASSWORD
  * you can create a NODE_ID with: php -r 'echo uniqid() . "\n";'
  * sysrc librenms_enable="YES"
  * service librenms start

20200501:
  AFFECTS: users of www/phpmyfaq
  AUTHOR: flo@FreeBSD.org

  phpMyFAQ has been updated to 3.0.2, old templates are not compatible with
  this new version. Please see:

  https://www.phpmyfaq.de/docs/3.0#3.4

20200428:
  AFFECTS: users of sysutils/ansible
  AUTHOR: bofh@FreeBSD.org

  Ansible has been updated to 2.9.7. Please follow the porting guide
  to update the rulesets:

  https://docs.ansible.com/ansible/devel/porting_guides/porting_guide_2.9.html

  If you wish to stay with 2.8 version, you can switch
  to new sysutils/ansible28 port, which tracks stable 2.8 branch:

  # pkg set -n ansible:ansible28

20200428:
  AFFECTS: x11-servers/xwayland-devel
  AUTHOR: jbeich@FreeBSD.org

  DRI3 is enabled by default since mesa-libs-18.3.2_4, so you no
  longer need to define LIBGL_DRI3_ENABLE in ~/.profile or ~/.login.

  See 20200308 entry for more details.

20200422:
  AFFECTS: users of devel/kyua
  AUTHOR: brooks@FreeBSD.org

  A tests group has been added and the tests user should be a member
  of it by default rather than nobody. You should update your password
  database to match (change the group from 65534 to 977 after updating).

  Please use the following command to do so:

  pw usermod -n tests -g tests

20200408:
  AFFECTS: users of security/openssh-portable
  AUTHOR: bdrewery@FreeBSD.org

  OpenSSH was upgraded to 8.2p1 on 2020-03-23.

  A restart of sshd is required after upgrade due to an incompatibility
  introduced in 8.2.

  Please see https://www.openssh.com/txt/release-8.2 for upcoming
  deprecation notices.

20200408
  AFFECTS: users of net/irrd
  AUTHOR: bofh@FreeBSD.org

  Legacy version of net/irrd has been moved to net/irrd-legacy.
  net/irrd has been upgraded to 4.X branch. If someone wants to stick with
  legacy version then pkg users have to do something like

  # pkg set -o net/irrd:net/irrd-legacy

  For portmaster users
  # portmaster -o net/irrd-legacy net/irrd

  Both of the version can be installed and used concurrently in case there is
  a need for migration

20200403:
  AFFECTS: users of x11-fonts/fontconfig
  AUTHOR: desktop@FreeBSD.org

  Fontconfig 2.13.1 generated .uuid files in the fonts directory which where
  not properly registered to the packages. To clean them up, please execute the
  following command:

  	find /usr/local/share/fonts -type f -name .uuid -delete

20200326:
  AFFECTS: users of devel/sonarqube and devel/sonar-ant-task
  AUTHOR: netchild@FreeBSD.org

  The outdated port devel/sonarqube has moved to
  devel/sonarqube-community to make it clear that it is the community
  edition. The log and DB files are still stored in the same location.

  The devel/sonar-ant-task port has moved to devel/sonarqube-ant-task
  to match the upstream-name. The install location is renamed
  accordingly.

  At the same time the user/group of the sonarqube port changed from
  www:www to sonarqube:sonarqube.

  It is expected that nobody was using the 6.2 version from 2016
  anymore and no change needs to be done. No analysis was done to check
  if the old 6.2 version can be updated in-place to the 8.2 version.
  As such if there is still someone using the old 6.2 version, you may
  have to delete /var/log/sonarqube and /var/db/sonarqube before
  installing the new version.

20200320
  AFFECTS: users of devel/qca
  AUTHOR: kde@FreeBSD.org

  New versions of devel/qca stopped supporting OpenSSL < 1.1.
  For this reason devel/qca-legacy has been added, which is
  held back at an older version until FreeBSD 11 goes EOL.

  Ports depending on devel/qca should stop adding direct LIB_DEPENDS
  and switch to depending on it via USES=qca.

  FreeBSD 11 users might want to run something like

      pkg set -o devel/qca:devel/qca-legacy

20200320:
  AFFECTS: users of x11/libxkbcommon
  AUTHOR: zeising@FreeBSD.org

  The libxkbcommon library (x11/libxkbcommon), used to handle keyboards
  in some applications, most notably kde and wayland, have been switched
  to use evdev rules by default on FreeBSD 12 and later.  Some keys, most
  notably arrow keys, may not work in applications using libxkbcommon if
  you are using xf86-input-keyboard rather than xf86-input-libinput.
  If you have trouble with the keyboard keys, and if /var/log/Xorg.*.log
  shows that the "kbd" or "keyboard" driver is being used, you need to
  switch to legacy rules by setting the environment variable
  XKB_DEFAULT_RULES to xorg.
  This switch is made to match the default configuration on FreeBSD 12.1 and
  later, the default configuration on FreeBSD 11.3 still uses the legacy
  rules.

20200316:
  AFFECTS: users of net-im/slack-term
  AUTHOR: dmgk@FreeBSD.org

  The config file location was changed from ~/.slack-term to
  ~/.config/slack-term/config, please move your existing config file
  accordingly.

20200308
  AFFECTS: users of graphics/mesa-libs and legacy graphics drivers
  AUTHOR: zeising@FreeBSD.org

  The mesa OpenGL library (graphics/mesa-libs) has been switched to use DRI3
  by default, instead of the older DRI2 interface.  This might cause regressions
  when using the legacy graphics drivers, either through
  graphics/drm-legacy-kmod or the graphics drivers in base.

  If you experience issues when running OpenGL applications it is possible
  to force the use of DRI2 by setting the LIBGL_DRI3_DISABLE environment
  variable to 1 before starting any OpenGL application.  The easiest way to
  do this is by adding it to either your shell startup files or .xinitrc.

20200306
  AFFECTS: users of databases/mysql80-server
  AUTHOR: joneum@FreeBSD.org

  As of MySQL 8.0.16, the MySQL server performs the upgrade tasks previously
  handled by mysql_upgrade. Consequently, mysql_upgrade is unneeded and is
  deprecated as of that version, and will be removed in a future MySQL version.
  Because mysql_upgrade no longer performs upgrade tasks,
  it exits with status 0 unconditionally.

20200303:
  AFFECTS: users of net-mgmt/librenms
  AUTHOR: dvl@FreeBSD.org

  1. Apache / mod_php options removed

  The APACHEMOD option has been removed. LibreNMS can be used
  with other webservers, not just Apache. In order to simplify
  the port, the option was removed.

  Now you manually install the webserver of your preference.

  If upgrading from LibreNMS < 1.61, you can do this to
  prevent 'pkg autoremove' from uninstalling Apache / mod_php:

  $ sudo pkg set -A 0 apache24 mod_php74
  Mark apache24-2.4.41 as not automatically installed? [y/N]: y
  Mark mod_php74-7.4.3 as not automatically installed? [y/N]: y

  Adjust mod_php74 to suit the version of mod_php you have.

  2. include/defaults.inc.php is gone

  The file include/defaults.inc.php is no longer distributed by
  the upstream project. The FreeBSD port patched this file to
  correct the paths to common tools such as ping, snmpwalk, etc.

  These values previously adjusted by the port must now be specified
  in config.php. New installs will have this automatically, but existing
  installs must be updated manually. These are the entries you should
  add if upgrading from LibreNMS < 1.61:

  $config['snmpwalk']       = '/usr/local/bin/snmpwalk';
  $config['snmpget']        = '/usr/local/bin/snmpget';
  $config['snmpbulkwalk']   = '/usr/local/bin/snmpbulkwalk';
  $config['snmptranslate']  = '/usr/local/bin/snmptranslate';

  $config['ping']           = '/sbin/ping';
  $config['mtr']            = '/usr/local/bin/mtr';
  $config['nmap']           = '/usr/local/bin/nmap';

  $config['nagios_plugins'] = '/usr/local/libexec/nagios';
  $config['ipmitool']       = '/usr/local/bin/ipmitool';
  $config['virsh']          = '/usr/local/bin/virsh';
  $config['dot']            = '/usr/local/bin/dot';
  $config['sfdp']           = '/usr/local/bin/sfdp';
  $config['nfdump']         = '/usr/local/bin/nfdump';

20200229:
  AFFECTS: users of textproc/apache-solr
  AUTHOR: mfechner@FreeBSD.org

  Apache-solr switched to the supported java LTS version 11.
  Make sure you update the following files accordingly:
  /usr/local/etc/solr.in.sh (see /usr/local/etc/solr.in.sh.sample)
  /usr/local/etc/javavm_opts.conf (JAVA_HOME=/usr/local/openjdk11/)

20200225:
  AFFECTS: users of net-mgmt/netbox
  AUTHOR: kai@FreeBSD.org

  1. Removal of the Topology Maps feature

  The deprecated topology maps feature has been removed.  Please replicate
  any required data to another source before upgrading NetBox to v2.7.7, as
  any existing topology maps will be deleted.


  2. Changed REDIS database configuration settings

  The REDIS database configuration parameters were splitted up in two
  discrete subsections named "webhooks" and "caching" with the 2.7 release.
  This requires modification of the REDIS parameter in configuration.py as
  follows:

  Old Redis sample configuration:

  REDIS = {
    'HOST': 'localhost',
    'PORT': 6379,
    'PASSWORD': '',
    'DATABASE': 0,
    'CACHE_DATABASE': 1,
    'DEFAULT_TIMEOUT': 300,
    'SSL': False,
  }

  New Redis sample configuration:

  REDIS = {
    'webhooks': {
        'HOST': 'redis.example.com',
        'PORT': 1234,
        'PASSWORD': 'foobar',
        'DATABASE': 0,
        'DEFAULT_TIMEOUT': 300,
        'SSL': False,
    },
    'caching': {
        'HOST': 'localhost',
        'PORT': 6379,
        'PASSWORD': '',
        'DATABASE': 1,
        'DEFAULT_TIMEOUT': 300,
        'SSL': False,
    }
  }

  Note that the CACHE_DATABASE parameter has been removed and the connection
  settings have been duplicated for both webhooks and caching.  This allows
  one to make use of separate Redis instances if desired.  It is fine to use
  the same Redis service for both functions, although the database
  identifiers should be different.

  Please also check the pkg-message and the changelogs for further info.

20200223:
  AFFECTS: users of security/gsasl
  AUTHOR: hrs@FreeBSD.org

  The library part of security/gsasl has been split into security/libgsasl.
  The security/gsasl now depends on security/libgsasl. Due to this change,
  old security/gsasl conflicts with the new security/libgsasl and it can
  prevent the installed security/gsasl from upgrading. Please remove the
  installed security/gsasl before upgrading if a conflict error occurs.

20200220:
  AFFECTS: users of x11-servers/xorg-server
  AUTHOR: zeising@FreeBSD.org

  x11-servers/xorg-server has been updated to 1.20.7.

  With this update, xorg-server has switched from using the devd backend to
  the udev backend for device configuration on FreeBSD 12 and 13.  If you have
  issues with input devices, please see the install message for details.

  The HAL backend option has been completely removed, as it was deprecated.

  If you have problems with input devices, ensure that both x11/libinput and
  x11-drivers/xf86-input-libinput are installed.  They are installed in the
  default configuration, but if you have a custom configuration, they might not
  be.

20200210:
  AFFECTS: users of net-im/prosody
  AUTHOR: thomas@beingboiled.info

  Prosody's pid file and data directory have moved to a new location.
  If you are upgrading from a version with the pid file and data
  directory in /usr/local/var/lib/prosody please perform these steps:

    # stop Prosody
    pkill -F /usr/local/var/lib/prosody/prosody.pid

    # copy the data directory
    cp -a /usr/local/var/lib/prosody /var/db/prosody
    rm -f /var/db/prosody/prosody.pid

  Make sure your prosody config has the following option set:

    pidfile = "/var/run/prosody/prosody.pid"

  Then start Prosody again. Everything should be working as before and
  the /usr/local/var/lib/prosody directory can now be removed.

20200207:
  AFFECTS: users of security/nss
  AUTHOR: lwhsu@FreeBSD.org

  NSS header files and libraries have been moved from ${PREFIX}/include/nss/nss
  and ${PREFIX}/lib/nss to ${PREFIX}/include/nss and ${PREFIX}/lib

20200204:
  AFFECTS: users of editors/vim
  AUTHOR: adamw@FreeBSD.org

  The PYTHON2 and PYTHON3 options have been turned into a single PYTHON
  option that uses whichever python you've set as default. However,
  this means that you cannot have both python2 and python3 support at
  the same time.

20200126:
  AFFECTS: users of multimedia/gstreamer1-plugins[-bad]
  AUTHOR: kwm@freebsd.org

  In GStreamer 1.16 some files moved from the gstreamer1-plugins-bad package
  to the gstreamer1-plugins package.

  If your using a tool like portmaster or portupgrade delete the old -bad
  port and then follow the normal upgrade method.
  # pkg delete -f gstreamer1-plugins-bad

20200126:
  AFFECTS: users of sysutils/helm
  AUTHOR: danilo@FreeBSD.org

  The Helm project have deprecated the Tiller utility in Helm 3. If you are using
  Helm 2 you will need to migrate the configuration to be compatible with Helm 3.
  Please, refer to the following documentation for more information about the
  migration process:

  https://helm.sh/blog/migrate-from-helm-v2-to-helm-v3/

  Note that the 2to3 plugin binary is not available for FreeBSD and you will need
  to compile it yourself.

20200113:
  AFFECTS: users of python and net/samba410, devel/talloc, devel/tevent, databases/tdb, databases/ldb*
  AUTHOR: timur@FreeBSD.org

  In the entry 20191216 for the Python update the filtering constrains
  are too limiting and omit the Samba supplimentary libraries, which do
  have Python bindings to the default Python 3.x version. With the update
  of the default Python3 version you also need to rebuild all the
  supplimentary Samba libraries and samba410 itself.

  For portmaster users it would be enough to run:

  # portmaster devel/talloc devel/tevent databases/tdb databases/ldb15 net/samba410


20200109:
  AFFECTS: www/firefox
  AUTHOR: gecko@FreeBSD.org

  Firefox requires Capsicum since r522464 for IPC and in future will
  require Capsicum for process sandboxing. If you use a custom kernel
  make sure to copy the following lines from GENERIC kernel:

    options 	CAPABILITY_MODE		# Capsicum capability mode
    options 	CAPABILITIES		# Capsicum capabilities

20200107:
  AFFECTS: Users of *-emacs27-* packages
  AUTHOR: ashish@FreeBSD.org

  There is a major version bump in 28.0.50, therefore to upgrade all the
  packages dependent on editors/emacs-devel, please use the following commands:

    # sh
    # for i in $(pkg query -g %n '*-emacs27*'); do \
        nn=$(echo "$i" | sed -e 's/emacs27/emacs28/'); \
        pkg set -yn "$i":"$nn"; done;
    # pkg upgrade

20200106:
  AFFECTS: users of net/gnatsd
  AUTHOR: olgeni@FreeBSD.org

  net/gnatsd has been replaced by net/nats-server to reflect the
  new naming upstream.

  All options in rc.conf should be renamed by replacing 'gnats'
  with 'nats' (nats_enable, nats_user, nats_options).

20200101:
  AFFECTS: users of security/openssl and security/openssl111
  AUTHOR: brnrd@FreeBSD.org

  The openssl port was removed on 2019-12-31, subsequently the openssl111
  port was renamed to openssl on 2020-01-01.

  The shared library version of OpenSSL has been bumped.

  Users of DEFAULT_VERSIONS= ssl=openssl111 must update this to
  ssl=openssl.

  You must rebuild all ports that depend on OpenSSL if you use OpenSSL
  from ports.

20191226:
  AFFECTS: users of sysutils/dsbmd
  AUTHOR: mk@freeshell.de

  With version 1.10 dsbmd now uses sysutils/fusefs-jmtpfs for mounting
  MTP devices. Please adjust your dsbmd.conf or recreate it from the new
  dsbmd.conf.sample.

20191225:
  AFFECTS: multimedia/libva-intel-media-driver
  AUTHOR: jbeich@FreeBSD.org

  As of libva 2.6.0 iHD driver is automatically enabled, so you no
  longer need to adjust LIBVA_DRIVER_NAME in ~/.profile or ~/.login.

20191221:
  AFFECTS: users of misc/openhab2
  AUTHOR: netchild@FreeBSD.org

  If you upgrade from a pevious version, make a backup of
        /var/db/openhab2
  read about the breaking changes in the release notes at
        https://github.com/openhab/openhab-distro/releases/tag/2.5.0
  and run
        %%PREFIX%%/libexec/openhab2/runtime/bin/update.freebsd
  which takes care about changes for:
        - Textual Configuration
        - Next Generation Rule Engine

20191216:
  AFFECTS: users of python
  AUTHOR: antoine@FreeBSD.org

  Default version of python3 and python was switched to 3.7.

  For ports users wanting to keep version 3.6 as default,
  add DEFAULT_VERSIONS+= python=3.6 python3=3.6 to make.conf

  This may ease the upgrade for users of pre-build packages:
  # sh
  # for i in $(pkg query -g %n 'py36-*'); do pkg set -yn ${i}:py37-${i#py36-}; done
  # pkg upgrade

  For portmaster users:
  # sh
  # portmaster -o lang/python37 python36
  # REINSTALL="$(pkg info -o py36-\* | awk '{printf "%s ", $2}')"
  # pkg delete -f py36-\*
  # portmaster $REINSTALL
  # REBUILD=$(pkg query -g "%n:%dn" '*' | grep py3 | grep -v py37 | cut -d : -f 1 | sort -u)
  # portmaster $REBUILD
  # REBUILD2=$(pkg list | grep python-36 | xargs pkg which | awk '{print $6}' | sort -u)
  # portmaster $REBUILD2

20191204
  AFFECTS: users of mail/nextcloud-mail
  AUTHOR: brnrd@FreeBSD.org

  Version 0.20.0 removed the default mail configuration via config.php.
  All users will be prompted to enter account and SMTP- and IMAP-server
  details for sending and reading email.

20191126:
  AFFECTS: consumers of net/py-urllib3
  AUTHOR: kai@FreeBSD.org

  Since version 1.25 HTTPS connections are now verified by default which is
  done via "cert_reqs = 'CERT_REQUIRED'".  While certificate verification
  can be disabled via "cert_reqs = 'CERT_NONE'", it's highly recommended to
  leave it on.

  Various consumers of net/py-urllib3 already have implemented routines that
  either explicitly enable or disable HTTPS certificate verification (e.g.
  via configuration settings, CLI arguments, etc.).

  Yet it may happen that there are still some consumers which don't
  explicitly enable/disable certificate verification for HTTPS connections
  which could then lead to errors (as is often the case with self-signed
  certificates).

  In case of an error one should try first to temporarily disable
  certificate verification of the problematic urllib3 consumer to see if
  this approach will remedy the issue.

20191125:
  AFFECTS: users of emulators/qemu
  AUTHOR: bofh@FreeBSD.org

  emulators/qemu31 has been updated to 4.1.1. Previous 3.1.X branch has
  been repocopied to emulators/qemu31. If someone wants to stick with 3.1.X
  branch please use one of the following command:

  # pkg install emulators/qemu31
    or
  # portmaster -o emulators/qemu31 emulators/qemu
    or
  # portupgrade -o emulators/qemu31 emulators/qemu

20191124:
  AFFECTS: users of irc/eggdrop
  AUTHOR: dbaio@FreeBSD.org

  The irc/eggdrop port has been updated to 1.8.4 and its config is not
  backward compatible with 1.6.21. A new port was created to keep 1.6.21
  version available at irc/eggdrop16 and it will be available for 3 months
  until users have time to upgrade their configuration.

  More information at:
  https://raw.githubusercontent.com/eggheads/eggdrop/v1.8.4/NEWS

  If you would like to keep using 1.6.21, please run the following command
  to update pkg database:

    pkg set -n eggdrop:eggdrop16
    pkg set -o irc/eggdrop:irc/eggdrop16

20191108:
  AFFECTS: users of databases/redis[-devel]
  AUTHOR: osa@FreeBSD.org

  The databases/redis port has been updated to the recent stable release.
  Users wanting to stay on v4.x can replace databases/redis with
  databases/redis4 with one of the following commands:

  # pkg install databases/redis4
    or
  # portmaster -o databases/redis4 databases/redis
    or
  # portupgrade -o databases/redis4 databases/redis

20191103:
  AFFECTS: users of www/node
  AUTHOR: bhughes@FreeBSD.org

  The www/node port has been updated to Node.js v13.0.0, the latest
  upstream release. A new port, www/node12, has been created for the
  v12.x LTS branch. Users wanting to stay on v12.x can replace www/node
  with www/node12 with one of the following commands:

  # pkg install www/node12
    or
  # portmaster -o www/node12 www/node
    or
  # portupgrade -o www/node12 www/node

20191029:
  AFFECTS: users of emulators/open-vm-tools[-nox11]
  AUTHOR: jpaetzel@FreeBSD.org

open-vm-tools 11.0.1 has removed the vmxnet driver.  This driver has been
in tree for quite some time and hopefully everyone is using the in tree
version, however if you had removed device vmx from your kernel, or are
running an unsupported version of FreeBSD which didn't have the driver
included in the base system, updating your open-vm-tools version will
leave you without networking.

20191026:
  AFFECTS: users of www/qt5-webengine
  AUTHOR: kai@FreeBSD.org

  Users that upgrade www/qt5-webengine without using pkg/poudriere might
  experience failures due to conflicts with the installed version of 5.12.2.

  In that case, pkg delete -f the qt5-webengine package before building
  the updated version.

20191025:
  AFFECTS: users of x11/nvidia-driver (and slave ports)
  AUTHOR: danfe@FreeBSD.org

  x11/nvidia-driver* ports no longer install Linux programs and libraries,
  which had been moved to their own ports (x11/linux-nvidia-libs*).  When
  updating the driver package next time, remember to install them manually
  if you need to run Linux OpenGL programs.

20191016:
  AFFECTS: users of KDE Plasma Desktop (x11/plasma5*)
  AUTHOR: kde@FreeBSD.org

  With Plasma 5.17 the startup script has been renamed. People who use the
  .xinitrc method to start Plasma have to call the new binary.

  Previously:
  	exec ck-launch-session startkde
  Change to:
  	exec ck-launch-session startplasma-x11

20191014:
  AFFECTS: users of mail/rspamd, mail/rspamd-devel
  AUTHOR: vsevolod@FreeBSD.org

  Sample configuration files has been removed as default configuration files
  are NOT intended for modification by users and SHOULD be overwritten on
  port upgrade.

  Make sure the default configuration files are unmodified and migrate all
  configuration changes to the proper places, before you continue.

20191002:
  AFFECTS: users of textproc/groff
  AUTHOR: bapt@FreeBSD.org

  with groff 1.2.4_3, groff does not depend anymore on ghostscript and
  netpbm. In order to be able to properly use the html backend the user
  can install ghostscript and netpbm from ports without the need of
  reinstalling the package.

  Also note that the X11 option has been removed.

20190930:
  AFFECTS: users of net-mgmt/netbox
  AUTHOR: kai@FreeBSD.org

  Since the 2.6 release a running Redis server instance is required for
  caching objects to run.  Also the following settings like below need to be
  added (or modified) in the existing configuration.py:

  REDIS = {
    'HOST': 'localhost',
    'PORT': 6397,
    'PASSWORD': ''
    'DATABASE': 0,
    'CACHE_DATABASE': 1,
    'DEFAULT_TIMEOUT': 300,
    'SSL': False,
  }

  Note that if you were using these settings in a prior release with
  webhooks, the DATABASE setting remains the same but an additional
  CACHE_DATABASE settings has been added with a default value of 1 to
  support the caching backend.

  The DATABASE setting will be renamed in a future release of NetBox to
  better relay the meaning of the setting.  It is highly recommended to keep
  the webhook and cache databases separate.  Using the same database number
  for both may result in webhook processing data being lost during cache
  flushing events.

  Please also check the pkg-message and the changelogs for further info.

20190927:
  AFFECTS: users of emulators/qemu-devel
  AUTHOR: bofh@FreeBSD.org

  qemu-devel has been updated to 4.1.0 and 4.0.0 has been merged into a new port
  emulators/qemu40. If you want to stick with 4.0.X branch, simply use:
  # portmaster -o emulators/qemu-devel emulators/qemu40

20190927:
  AFFECTS: users of XFCE desktop (x11-wm/xfce4)
  AUTHOR: madpilot@FreeBSD.org

  Due to changes in the XFCE 4.14 metaport, systems could end up with
  both xscreensaver and xfce4-screensaver installed and enabled
  simultaneously.

  This can cause conflicts and problems unlocking the screen.

  To avoid problems, please make sure to have only one enabled by
  going to the Application Autostart tab of the Session and Startup
  settings applet and enable only one Screensaver there.

  Some further information can be found in the xfce4-session
  pkg-message displayed on installation and upgrade.

20190920:
  AFFECTS: users of net-mgmt/pushgateway
  AUTHOR: 0mp@FreeBSD.org

  The persistent storage format used by pushgateway in the latest version
  is not backwards compatible. See the pushgateway changelogs for details.

20190911:
  AFFECTS: users of security/bastillion
  AUTHOR: netchild@FreeBSD.org

  The datastore of bastillion needs to be updated:
    java -jar $PREFIX/jetty_bastillion/upgrade/bastillion-upgrade-3.08.00.jar \
      $PREFIX/jetty_bastillion/bastillion/WEB-INF/classes/BastillionConfig.properties

20190909:
  AFFECTS: users of lang/ruby25
  AUTHOR: mfechner@FreeBSD.org

  The default ruby version has been updated from 2.5 to 2.6.

  If you compile your own ports you may keep 2.5 as the default version by
  adding the following lines to your /etc/make.conf file:

  #
  # Keep ruby 2.5 as default version
  #
  DEFAULT_VERSIONS+=ruby=2.5

  If you wish to update to the new default version, you need to first stop any
  software that uses ruby. Then, you will need to follow these steps, depending
  upon how you manage your system.

  If you use pkgng, simply upgrade:
  # pkg upgrade

  If you do not use pkg, please check entry 20190420.
  The description there should also work for this version.

20190906:
  AFFECTS: users of devel/py-fabric
  AUTHOR: dbaio@FreeBSD.org

  Fabric (devel/py-fabric) was upgraded to 2.5.0, Fabric (2+) represents
  a near-total reimplementation and reorganization of the software.

  Fabric 2 is not at 100% feature parity with 1.x! Some features have been
  explicitly dropped, but others simply have not been ported over yet,
  either due to time constraints or because said features need to be
  re-examined in a modern context.

  More information at:
  https://www.fabfile.org/upgrading.html#upgrading
  https://www.fabfile.org/upgrading.html#upgrade-specifics

  If you would like to keep using 1.x, please run the following command to
  update pkg database:

    pkg set -n py27-fabric:py27-fabric1
    pkg set -o devel/py-fabric:devel/py-fabric1

20190830:
  AFFECTS: users of www/gitlab-ce
  AUTHOR: mfechner@FreeBSD.org

  Make sure you upgrade your PostgreSQL to version 11 as described in 20190829,
  before you upgrade your gitlab-ce version.
  Gitlab-ce 12.1 needs at least PostgreSQL version 9.6.

  After this you can follow the usual upgrade guide:
  https://gitlab.fechner.net/mfechner/Gitlab-docu/blob/master/update/12.0-12.1-freebsd.md

20190829:
  AFFECTS: users of database/postgresql* and other software using PostgreSQL to run
  AUTHOR: tz@FreeBSD.org

  The default version of PostgreSQL has been switched from 9.5 to 11.
  The upgrade procedure can use up twice the space the databases
  currently needs. If you have a big amount of stored data take a
  closer look at the manpage of pg_upgrade for avoidance and/or
  speedup of the upgrade.

  The upgrade instructions consider a basic usage and do not match
  complex scenarios like replication, sharding, or similar.

  Upgrade instructions:

  First stop your PostgreSQL, create PostgreSQL-binaries and backup your data.
  If you have another Version of PostgreSQL installed, for example 9.5.19, your
  files are named according to this.

  # service postgresql stop
  # pkg create postgresql95-server postgresql95-contrib
  # mkdir /tmp/pg-upgrade
  # tar xf postgresql95-server-9.5.19.txz -C /tmp/pg-upgrade
  # tar xf postgresql95-contrib-9.5.19.txz -C /tmp/pg-upgrade
  # pkg delete -f databases/postgresql95-server databases/postgresql95-contrib databases/postgresql95-client

  Now update PostgreSQL:

    pkg user:
    # pkg install databases/postgresql11-server databases/postgresql11-contrib
    # pkg upgrade

    Portmaster users:
    # portmaster databases/postgresql11-server databases/postgresql11-contrib
    # portmaster -a

    Portupgrade users:
    # portinstall databases/postgresql11-server databases/postgresql11-contrib
    # portupgrade -a

  After installing the new PostgreSQL version you need to convert
  all your databases to new version:

  # su -l postgres -c "/usr/local/bin/initdb --encoding=utf-8 --lc-collate=C -D /var/db/postgres/data11 -U pgsql"
  # chown -R postgres /usr/local/pgsql/data/
  # su -l postgres -c "pg_upgrade -b /tmp/pg-upgrade/usr/local/bin/ -d /usr/local/pgsql/data/ -B /usr/local/bin/ -D /var/db/postgres/data11/ -U pgsql "

  Now the migration is finished. You can start PostgreSQL again with:

  # service postgresql start

  ATTENTION:
  1) The default user changed from "pgsql" to "postgres". The migration steps above preserve
     the "pgsql" database user while the database daemon is now executed as the "postgres" FreeBSD user.
  2) The default data dir changed from "/usr/local/pgsql/data/" to "/var/db/postgres/data11/"
  3) If you use non-default initdb options, you have to adjust the initdb-command accordingly

20190816:
  AFFECTS: users of net-im/ejabberd
  AUTHOR: ashish@FreeBSD.org

  Riak support has been removed by upstream. For update instructions from
  19.05, please refer to:

  https://docs.ejabberd.im/admin/upgrade/from_19.05_to_19.08/

20190812:
  AFFECTS: users of lang/perl5*
  AUTHOR: mat@FreeBSD.org

  The default Perl version has been switched to Perl 5.30.  If you are using
  binary packages to upgrade your system, you do not have anything to do, pkg
  upgrade will do the right thing.  For the other people, follow the
  instructions in entry 20161103, it should still be the same.

20190801:
  AFFECTS: users of www/ot-recorder
  AUTHOR: dvl@FreeBSD.org

  The data directory has moved from /var/spool/owntracks to
  /var/db/owntracks

  Be sure to stop otrecorder, move the directory, and start otrecorder.

  service ot-recorder stop
  cd /var/spool
  mv owntracks /var/db
  service ot-recorder start

20190728:
  AFFECTS: users of net-im/py-matrix-synapse
  AUTHOR: kai@FreeBSD.org

  The support for Python 2.7 has been dropped with the 1.1.0 release of
  net/py-matrix-synapse.

  Users that still use the Python 2.7 version of net-im/py-matrix-synapse
  should switch to a newer Python version, e.g. 3.6, which is the default
  Python version since April 2019.

